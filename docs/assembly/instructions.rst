Збір пристрою
=============

:term:`PCB` Лілки спроєктована для максимально простого збору зі збереженням її мінімального розміру.

Більшість компонентів - це :term:`THT`-компоненти, тобто компоненти, які вставляються в отвори плати і паяються з задньої сторони. Це дозволяє збирати плату без використання спеціального обладнання.

Декілька компонентів - це :term:`SMD`-компоненти, які паяються зверху. Серед них - мікроконтролер ESP32-S3-WROOM-1-N16R8, регулятор напруги TLV1117LV-33DCYR та транзистор IRLML6401.

Порядок збору
-------------

1. **Перш за все, припаяйте SMD-компоненти.**

   Вони займають найменше місця та не заважатимуть вам при пайці решти компонентів.**

   * ``U1`` (мікроконтролер ESP32-S3-WROOM-1-N16R8)
   * ``U3`` (регулятор TLV1117LV-33DCYR)
   * ``Q1`` IRLML6401 (якщо ви використовуєте комплектацію з батареєю)

2. **Припаяйте модуль USB-C** (``J1``).

   Переконайтесь, що ви вставили модуль USB-C вірно. Він має бути вирівняний з краєм плати.

   Є два способи паяти такі модулі на плату:

   - **Спосіб 1**: Ви можете прикласти його до плати та вставити штирьові контакти крізь нього та плату, утворивши таким чином "сендвіч". Після цього вам потрібно припаяти штирьові контакти з обох сторін.
     Таким чином модуль щільно прилягатиме до плати та не буде провисати.

     .. image:: ./images/sandwich.png

   - **Спосіб 2**: Ви можете спершу припаяти штирьові контакти на модуль USB-C, а потім припаяти модуль на плату. Цей спосіб простіший, але модуль буде провисати, оскільки між
     ним та платою буде вільний простір, утворений пластиковим тримачем штирьових контактів.

     .. image:: ./images/hover.png

   Є й інші способи - не бійтесь проявляти креативність!

3. **Якщо ви збираєте комплектацію з батареєю, припаяйте наступні компоненти (вони всі позначені пунктирними лініями на задній стороні плати)**

   * ``Q1`` IRLML6401
   * ``D1`` (діод 1N4001)
   * Резистори ``R3`` (100 кОм) та ``R4`` (33 кОм)
   * ``J4`` (модуль заряду/розряду батареї на базі TP4056)
   * LiPo батарея на ваш вибір (припаюється безпосередньо до пінів модуля заряду/розряду, позначених як B+ та B-)

   .. note::
      Обов'язково перевірте максимальний допустимий струм заряду вашого акумулятора! Модуль TP4056 по замовчуванню заряджає акумулятор струмом 1А. 
      Струм заряду можна корегувати заміною резистора R3(R_PROG) на платі модуля TP4056. 
   
   .. list-table:: **Таблиця зарядного струму**
      :widths: 25 25
      :header-rows: 1

      * - **Резистор (R_PROG)**
        - **Струм заряджання (I_charge)**
      * - 30 кОм
        - 40 мА
      * - 10 кОм
        - 120 мА
      * - 5 кОм
        - 240 мА
      * - 4 кОм
        - 300 мА
      * - 3 кОм
        - 400 мА
      * - 2 кОм
        - 600 мА
      * - 1.5 кОм
        - 800 мА
      * - 1.2 кОм
        - 1000 мА
      * - 1 кОм
        - 1200 мА  


   **Якщо ви збираєте комплектацію без батареї, не паяйте ці компоненти!**

   Натомість **замкніть** джампер ``JP1``, який знаходиться всередині посадкового місця діода ``D1``. Для цього використайте паяльник та припій, щоб замкнути контакти джампера.

4. **Припаяйте наступні компоненти:**

   * Резистори ``R1`` (10 кОм) ``R2`` (100 кОм)
   * Конденсатори ``C1`` (1 мкФ), ``C2`` та ``C3`` (10 мкФ)

5. **Припаяйте 6-мм тактильні кнопки**:

   * ``SW9`` (Select)
   * ``SW10`` (Start)
   * ``SW12`` (Start)

6. **Припаяйте модуль SD-карти** ``J3``.

   Як і модуль USB-C, модуль SD-карти можна припаяти двома способами.

   **Переконайтесь, що ви вставили модуль SD-карти вірно!** Металеве гніздо для SD-карти повинне знаходитися **зовні** плати!

7. **Припаяйте 8 12-мм кнопок**:
   
   * ``SW1`` (Up)
   * ``SW2`` (Down)
   * ``SW3`` (Left)
   * ``SW4`` (Right)
   * ``SW5`` (A)
   * ``SW6`` (B)
   * ``SW7`` (C)
   * ``SW8`` (D)

8. **Якщо ви збираєте комплектацію зі звуком, припаяйте** :term:`ЦАП`-модуль ``U4`` (MAX98357A).

   * **Якщо ви плануєте використовувати навушники,** спершу припаяйте роз'єм для навушників ``J6`` до плати. Після цього обов'язково припаяйте всі 9 контактів модуля MAX98357A.
   * **Якщо ж ви хочете використовувати власний динамік,** вам достатньо припаяти лише 7 основних контактів, а контакти динаміка припаяти безпосередньо до пінів (+) та (-) модуля.

9. **Припаяйте п'єзоелектричний динамік** ``BZ1``.

   Він дозволяє відтворювати примітивні звуки. Він працює окремо від :term:`ЦАП`-модуля, тому ви можете використовувати його навіть якщо не паяєте :term:`ЦАП`-модуль.

10. **Припаяйте роз'єм дисплея та роз'єм розширення:**

   * ``U2`` (роз'єм дисплея типу "мама")
   * ``J2`` (роз'єм розширення типу "тато")

11. **Припаяйте вимикач живлення** ``SW11``.

Вітаємо, ваша плата готова до використання! Тепер вам залишається лише завантажити програмне забезпечення на ESP32-S3. Для цього читайте наступний розділ - :ref:`programming`.
